THREE.TGALoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TGALoader.prototype={constructor:THREE.TGALoader,load:function(e,a,r,o){var t=this,i=new THREE.Texture,n=new THREE.FileLoader(this.manager);return n.setResponseType("arraybuffer"),n.setPath(this.path),n.load(e,(function(e){i.image=t.parse(e),i.needsUpdate=!0,void 0!==a&&a(i)}),r,o),i},parse:function(e){var a=0,r=1,o=2,t=3,i=9,n=10,s=11,c=48,d=4,l=0,h=1,p=2,f=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var g=new Uint8Array(e),u=0,E={id_length:g[u++],colormap_type:g[u++],image_type:g[u++],colormap_index:g[u++]|g[u++]<<8,colormap_length:g[u++]|g[u++]<<8,colormap_size:g[u++],origin:[g[u++]|g[u++]<<8,g[u++]|g[u++]<<8],width:g[u++]|g[u++]<<8,height:g[u++]|g[u++]<<8,pixel_size:g[u++],flags:g[u++]};!function(e){switch(e.image_type){case r:case i:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case o:case t:case n:case s:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case a:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(E),E.id_length+u>e.length&&console.error("THREE.TGALoader: No data."),u+=E.id_length;var T=!1,m=!1,_=!1;switch(E.image_type){case i:T=!0,m=!0;break;case r:m=!0;break;case n:T=!0;break;case o:break;case s:T=!0,_=!0;break;case t:_=!0}var v="undefined"!=typeof OffscreenCanvas,w=v?new OffscreenCanvas(E.width,E.height):document.createElement("canvas");w.width=E.width,w.height=E.height;var y=w.getContext("2d"),b=y.createImageData(E.width,E.height),R=function(e,a,r,o,t){var i,n,s,c;if(n=r.pixel_size>>3,s=r.width*r.height*n,a&&(c=t.subarray(o,o+=r.colormap_length*(r.colormap_size>>3))),e){var d,l,h;i=new Uint8Array(s);for(var p=0,f=new Uint8Array(n);p<s;)if(l=1+(127&(d=t[o++])),128&d){for(h=0;h<n;++h)f[h]=t[o++];for(h=0;h<l;++h)i.set(f,p+h*n);p+=n*l}else{for(l*=n,h=0;h<l;++h)i[p+h]=t[o++];p+=l}}else i=t.subarray(o,o+=a?r.width*r.height:s);return{pixel_data:i,palettes:c}}(T,m,E,u,g);!function(e,a,r,o,t){var i,n,s,g,u,T;switch((E.flags&c)>>d){default:case p:i=0,s=1,u=a,n=0,g=1,T=r;break;case l:i=0,s=1,u=a,n=r-1,g=-1,T=-1;break;case f:i=a-1,s=-1,u=-1,n=0,g=1,T=r;break;case h:i=a-1,s=-1,u=-1,n=r-1,g=-1,T=-1}if(_)switch(E.pixel_size){case 8:!function(e,a,r,o,t,i,n,s){var c,d,l,h=0,p=E.width;for(l=a;l!==o;l+=r)for(d=t;d!==n;d+=i,h++)c=s[h],e[4*(d+p*l)+0]=c,e[4*(d+p*l)+1]=c,e[4*(d+p*l)+2]=c,e[4*(d+p*l)+3]=255}(e,n,g,T,i,s,u,o);break;case 16:!function(e,a,r,o,t,i,n,s){var c,d,l=0,h=E.width;for(d=a;d!==o;d+=r)for(c=t;c!==n;c+=i,l+=2)e[4*(c+h*d)+0]=s[l+0],e[4*(c+h*d)+1]=s[l+0],e[4*(c+h*d)+2]=s[l+0],e[4*(c+h*d)+3]=s[l+1]}(e,n,g,T,i,s,u,o);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(E.pixel_size){case 8:!function(e,a,r,o,t,i,n,s,c){var d,l,h,p=c,f=0,g=E.width;for(h=a;h!==o;h+=r)for(l=t;l!==n;l+=i,f++)d=s[f],e[4*(l+g*h)+3]=255,e[4*(l+g*h)+2]=p[3*d+0],e[4*(l+g*h)+1]=p[3*d+1],e[4*(l+g*h)+0]=p[3*d+2]}(e,n,g,T,i,s,u,o,t);break;case 16:!function(e,a,r,o,t,i,n,s){var c,d,l,h=0,p=E.width;for(l=a;l!==o;l+=r)for(d=t;d!==n;d+=i,h+=2)c=s[h+0]+(s[h+1]<<8),e[4*(d+p*l)+0]=(31744&c)>>7,e[4*(d+p*l)+1]=(992&c)>>2,e[4*(d+p*l)+2]=(31&c)>>3,e[4*(d+p*l)+3]=32768&c?0:255}(e,n,g,T,i,s,u,o);break;case 24:!function(e,a,r,o,t,i,n,s){var c,d,l=0,h=E.width;for(d=a;d!==o;d+=r)for(c=t;c!==n;c+=i,l+=3)e[4*(c+h*d)+3]=255,e[4*(c+h*d)+2]=s[l+0],e[4*(c+h*d)+1]=s[l+1],e[4*(c+h*d)+0]=s[l+2]}(e,n,g,T,i,s,u,o);break;case 32:!function(e,a,r,o,t,i,n,s){var c,d,l=0,h=E.width;for(d=a;d!==o;d+=r)for(c=t;c!==n;c+=i,l+=4)e[4*(c+h*d)+2]=s[l+0],e[4*(c+h*d)+1]=s[l+1],e[4*(c+h*d)+0]=s[l+2],e[4*(c+h*d)+3]=s[l+3]}(e,n,g,T,i,s,u,o);break;default:console.error("THREE.TGALoader: Format not supported.")}}(b.data,E.width,E.height,R.pixel_data,R.palettes);return y.putImageData(b,0,0),v?w.transferToImageBitmap():w},setPath:function(e){return this.path=e,this}};